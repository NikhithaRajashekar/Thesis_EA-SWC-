---
title: "Finding similarity between names of a component in different models(Version3)"
author: "niki"
date: "17 December 2017"
output: html_document

---
## R Markdown
Finding similarity between names of a components between version 1 and version3. In version 3, few components added and removed and changes made from v1. This case study helps to find how similar the names of a components are similar in different models.
Cosine similarity is used to check the difference between the names

##load specific libraries
```{r}

library(readxl)
library(dplyr)
library(proxy)
library(stringr)
library(data.table)
library(tm)
library(SnowballC)
```

#load version 1 and version3 component elements
```{r}
library(readr)
#version 1 component list
elements1 <- read_csv("H:/theis_work/SWC_chair_ml_related/Archi_data/01old_version1_airport_model/elements1.csv")
dim(elements1)

#version 3 component list
elements3 <- read_csv("H:/theis_work/SWC_chair_ml_related/Archi_data/03airport_version3/elements.csv")
dim(elements3)
```

#subset the application layer and match names in application layer only

```{r}
e1<- elements1[grep("^Appli", elements1$Type), ]
e2<- elements3[grep("^Appli", elements3$Type), ]
```

##compute word frequency table

```{r}
#preprocess the name column
doc<-list(e1$Name, e2$Name)

doc1 <- lapply(doc, function(x) {
  text <- gsub("[[:punct:]]", "", x) %>% tolower()
  text <- gsub("\\s+", " ", text) %>% str_trim()  
  word <- strsplit(text, " ") %>% unlist()
  
  
  return(word)
})
# print only the first text to conserve space
doc1[[1]]

Shingling <- function(document, k) {
  shingles <- character( length = length(document) - k + 1 )
  
  for( i in 1:( length(document) - k + 1 ) ) {
    shingles[i] <- paste( document[ i:(i + k - 1) ], collapse = " " )
  }
  
  return( unique(shingles) )  
}

# "shingle" our example document, with k = 1
doc1 <- lapply(doc1, function(x) {
  Shingling(x, k = 1)
})
list( Original = doc[[1]], Shingled = doc1[[1]] )

# unique shingles sets across all documents
doc_dict <- unlist(doc1) %>% unique()

# "characteristic" matrix
M <- lapply(doc1, function(set, dict) {
  as.integer(dict %in% set)
}, dict = doc_dict) %>% data.frame() 

# set the names for both rows and columns
setnames( M, paste( "doc", 1:length(doc1), sep = "_" ) )
rownames(M) <- doc_dict
M
```

### Calculate distance using cosine similarity metric
```{r}
library(lsa)
cosine(M$doc_1, M$doc_2)
```

#alter
#crossprod(sen1, sen2)/sqrt(crossprod(sen1) * crossprod(sen2))

##TODO 
#you can also find similar between the layers ie. subsetting edge set from business, application/technology and comparing with other edge set of another model.
#subset the business layer
